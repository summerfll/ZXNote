# 【计算机网络】网络安全（二）

## 一.鉴别

鉴别是要验证通信的对方的确是自己所要通信的对象，而不是其他的冒充者。

鉴别分为两种：（1）报文鉴别，即所收到的报文的确是报文的发送者所发送，而不是其他人伪造的或篡改的

（2）实体鉴别，实体可以是一个人，也可以是一个进程。

### 1.报文鉴别

报文摘要MD是进行报文鉴别的简单方法。

![28](F:\学习专用\学习笔记\图片\28.png)

**鉴别过程：**

（1）形成报文鉴别码并发送

A把较长的报文X经报文摘要算法运算后得出很短的报文摘要H。然后用自己的私钥对H进行D运算，即进行数字签名。得出已签名的报文摘要。这个已签名的报文摘要称为报文鉴别码MAC。然后将MAC放在报文X的前面发送给B。

（2）B进行报文鉴别

B收到报文后先将MAC和报文X分离，然后a.用A的公钥对报文鉴别码MAC进行E运算，还原出报文摘要H。b.对报文X进行报文摘要运算，得到报文摘要H。如一样，就能基本确定收到的报文是A产生的。

报文摘要优点：

报文X和报文鉴别码MAC合在一起，是不可伪造的，是**可检验**和**不可否认**的。

### 2.实体鉴别

报文鉴别对每一个收到的报文都要鉴别报文的发送者，而实体鉴别是在系统接入的全部持续时间内对自己通信的对方实体**只需验证一次**。

#### **重放攻击：**

![29](F:\学习专用\学习笔记\图片\29.png)

如图，入侵者c易从网络中截获A发送给B的报文，C不需要破译报文，而是直接把这个报文发送给B，使B误认为C就是A，然后B就向伪装是A的C发送许多应向A发送的的报文。

为对付重放攻击，可以使用不重复数，就是一个使用不重复使用的大随机数，即一次一数。

#### 使用不重复数鉴别

![30](F:\学习专用\学习笔记\图片\30.png)

A首先用明文发送其身份A和一个不重复数RA给B，接着，B相应A的查问，用共享密钥KAB对RA加密后发回给A，同时给出自己的不重复数RB。最后，A再响应B的查问，用共享的密钥KAB对RB加密后发回B。

#### 中间人攻击

![31](F:\学习专用\学习笔记\图片\31.png)

## 二.密钥分配

由于密码算法是公开的，网络的安全性就完全基于密钥的安全保护上。因此在密码学中出现了一个重要的分支--密钥管理。密钥管理包括：密钥的产生、分配、注入、验证和使用。

**密钥分配**是密钥管理中最大的问题，密钥必须通过最安全的通路进行分配。

#### 对称密钥的分配

目前常用的密钥分配方式是设立密钥分配中心KDC。KDC是大家都信任的机构，其任务是给需要进行秘密通信的用户临时分配一个会话密钥（仅使用一次）。如图，假定A,B都是KDC的登记用户。A和B在KDC登记时就已经在KDC的服务器上安装了各自和KDC进行通信的主密钥KA和KB.

![32](F:\学习专用\学习笔记\图片\32.png)

- 用户A向密钥分配中心KDC发送时用明文，说明想和B通信。在明文中给出A和B在KDC登记的身份。
- KDC用随机数产生“一次一密”的会话密钥KAB供A和B的这次会话使用，然后向A发送回答报文。这个报文用A的密钥KA加密。
- 当B收到A转来报文并使用自己的密钥KB解密后，就知道A要和他通信，同时也知道KDC为这次和A通信所分配的会话密钥。